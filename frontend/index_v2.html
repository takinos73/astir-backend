<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASTIR CMMS â€“ Supervisor Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>

<!-- =====================
     LOGIN MODAL
===================== -->
<div id="loginOverlay" class="modal-overlay">
  <div class="modal-box modal-small">

    <h3>ğŸ” CMMS Login</h3>
    <p class="modal-subtitle">
      Enter access code to continue
    </p>

    <div class="login-form">

      <div class="field">
        <label>Role</label>
        <select id="loginRole">
          <option value="technician">Technician</option>
          <option value="planner">Planner</option>
          <option value="admin">Admin</option>
        </select>
      </div>

      <div class="field">
        <label>Password</label>
        <input
          id="loginPassword"
          type="password"
          placeholder="Access code"
          autocomplete="off"
        />
      </div>

      <div id="loginError" class="login-error" style="display:none;">
        âŒ Invalid credentials
      </div>

    </div>

    <div class="modal-actions">
      <button class="btn-primary" id="loginBtn">
        Login
      </button>
    </div>

  </div>
</div>


<!-- =====================
     TASK VIEW MODAL (SINGLE â€“ CLEAN)
===================== -->
<div id="taskViewOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide">

    <h3>Task Details</h3>

    <!-- =====================
         VIEW CONTENT
    ====================== -->
    <div id="taskViewContent" class="task-view-grid"></div>

    <!-- =====================
         EDIT PLANNED MANUAL
    ====================== -->
    <div class="task-edit-area" id="taskEditArea" style="display:none;">

      <div class="task-edit-header">
        <h4>âœï¸ Edit Task</h4>        
      </div>

      <div class="task-edit-grid">

        <div class="edit-field full">
          <label style="justify-self: start;">Task</label>
          <input id="edit-task-desc" />
        </div>

        <div class="edit-field">
          <label style="justify-self: start;">Type</label>
          <input id="edit-task-type" />
        </div>

        <div class="edit-field">
          <label>Due Date</label>
          <input id="edit-task-due" type="date" />
        </div>

        <div class="edit-field">
          <label>Section</label>
          <input id="edit-task-section" />
        </div>

        <div class="edit-field">
          <label>Unit</label>
          <input id="edit-task-unit" />
        </div>

        <div class="edit-field full">
          <label>Notes</label>
          <textarea id="edit-task-notes" rows="3"></textarea>
        </div>
      </div>

      <div class="task-edit-actions">
        <button class="btn-table" onclick="saveTaskEdit()">ğŸ’¾ Update</button>
        <button class="btn-cancel" onclick="cancelTaskEdit()">Cancel</button>
      </div>
    </div>

  <!-- ================
     ACTIONS
  ================= -->
<div class="modal-actions task-view-actions">

  <!-- Close -->
  <button class="btn-secondary" onclick="closeTaskView()">
    Close
  </button>

  <!-- ğŸ–¨ Print Work Order -->
  <button
    id="printTaskBtn"
    class="btn-print"
    type="button"
    onclick="printCurrentTask()">
    ğŸ–¨ Print Work Order
  </button>

  <!-- ğŸ†• CREATE FOLLOW-UP TASK -->
  <button
    id="createFollowupTaskBtn"
    class="btn-followup"
    style="display:none;"
    onclick="createFollowupTaskFromView()">
    â• Create Follow-up Task
  </button>

  <!-- Edit planned manual -->
  <button
    id="editTaskBtn"
    class="btn-edit"
    style="display:none;"
    onclick="enableTaskEdit()">
    âœï¸ Edit
  </button>

  <!-- Cancel planned manual -->
  <button
    id="deleteTaskBtn"
    class="btn-delete"
    style="display:none;"
    onclick="confirmDeleteTask()">
    ğŸ—‘ Cancel Task
  </button>

</div>

  </div>
</div>


<!-- =====================
     HISTORY MODAL
===================== -->
<div id="historyOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-history">
    <h3>ğŸ“‹ Executed Tasks</h3>
    <!-- =====================
     HISTORY FILTERS
    ===================== -->
<div class="history-filters">

  <!-- Date filter -->
  <select id="historyDateFilter">
    <option value="7">ğŸ“… Last 7 days</option>
    <option value="30">ğŸ“… Last 30 days</option>
    <option value="all">ğŸ“… All</option>
  </select>
<!-- Type filter -->
  <select id="historyTypeFilter">
  <option value="all">ğŸ“‚ All</option>
  <option value="unplanned">ğŸŸ¥ Breakdown</option>
  <option value="planned">ğŸŸ¨ Planned</option>
  <option value="preventive">ğŸŸ© Preventive</option>
</select>
  <!-- Machine / SN search -->
  <input
    type="text"
    id="historyMachineSearch"
    placeholder="ğŸ” Machine / SN"
  />
  

  <!-- Technician -->
  <input
    type="text"
    id="historyTechnicianSearch"
    placeholder="ğŸ‘¤ Technician"
  />

</div>
    <div class="table-card" style="max-height:67vh; overflow:auto;">
      <table id="historyTable">
        <thead>
          <tr>
            <th>Date</th>
            <th>Asset</th>
            <th style="width:35%">Task</th>
            <th>Executed By</th>
            <th style="width:11%">Actions</th> <!-- ğŸ‘ˆ UNDO -->
          </tr>
        </thead>
        <tbody>
          <!-- Rows rendered by JS -->
          <!--
          <tr>
            <td>13/01/2025 10:32</td>
            <td>
              MACHINE A<br>
              <small>SN-12345</small>
            </td>
            <td>Lubrication</td>
            <td>John</td>
            <td>
              <button class="btn-undo" onclick="undoExecution(12)">
                â†© Undo
              </button>
            </td>
          </tr>
          -->
        </tbody>
      </table>
    </div>
  <!-- =====================
     HISTORY LEGEND (CENTRAL)
===================== -->
<div class="history-legend">

  <div class="legend-item red">
    <span class="dot"></span>
    <span>Unplanned / Breakdown</span>
    <span class="count" id="centralHistoryBreakdownCount">0</span>
  </div>

  <div class="legend-item green">
    <span class="dot"></span>
    <span>Preventive Maintenance</span>
    <span class="count" id="centralHistoryPreventiveCount">0</span>
  </div>

  <div class="legend-item yellow">
    <span class="dot"></span>
    <span>Planned (Manual)</span>
    <span class="count" id="centralHistoryPlannedCount">0</span>
  </div>

</div>


  <!-- =====================
       ACTIONS
  ===================== -->
    <div class="modal-actions">
      <button class="btn-secondary" id="closeHistoryBtn">Close</button>
    </div>    
  </div>  
</div>

    <!-- ====================
     EDIT BREAKDOWN MODAL
    ===================== -->

<div id="editBreakdownOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-small">

    <h3>âœï¸ Edit Breakdown</h3>
    <p class="modal-subtitle">
      You can correct description, technician or notes.<br>
      Asset & date are locked for audit reasons.
    </p>

    <div class="edit-breakdown-form">

      <!-- Task -->
      <div class="field">
        <label>Task Description</label>
        <input id="eb-task" />
      </div>

      <!-- Technician -->
      <div class="field">
        <label>Executed By</label>
        <input id="eb-executed-by" />
      </div>

      <!-- Notes -->
      <div class="field">
        <label>Notes</label>
        <textarea
          id="eb-notes"
          rows="3"
          placeholder="Additional details, observations, root cause..."
        ></textarea>
      </div>

    </div>

    <div class="modal-actions">
      <button class="btn-table" onclick="saveBreakdownEdit()">ğŸ’¾ Save</button>
      <button class="btn-cancel" onclick="closeEditBreakdown()">Cancel</button>
    </div>

  </div>
</div>
<!-- =====================
     KPI / ANALYTICS MODAL
===================== -->
<div id="analyticsOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide">

    <h3>ğŸ“Š KPI / Analytics</h3>
    <p class="modal-subtitle tiny">
      Decision support metrics based on current maintenance data
    </p>

    <!-- =====================
         SECTION: WORKLOAD
    ===================== -->
    <section class="analytics-section">
      <h4>ğŸ›  Workload</h4>

      <div class="analytics-grid">
        <div class="analytics-card">
          <span class="label">Estimated workload (next 7 days)</span>
          <span class="value" id="kpiEstimatedWorkload7d">â€”</span>

        </div>

        <div class="analytics-card">
          <span class="label">Overdue workload</span>
          <span class="value">â€”</span>
        </div>
      </div>
    </section>

<!-- =====================
     SECTION: PLANNING MIX
===================== -->
<section class="analytics-section">
  <h4>ğŸ“… Planning Mix</h4>

  <div class="analytics-grid">
    <div class="analytics-card">    

      <!-- Time-based KPI (minutes) -->
      <span class="value" id="kpiPlanningMixTime">â€”</span>

      <!-- Count-based KPI (work orders) -->
      <span class="subvalue" id="kpiPlanningMixCount">â€”</span>
    </div>
  </div>
</section>

    <!-- =====================
     SECTION: RISK
    ===================== -->
<section class="analytics-section">
  <h4>âš ï¸ Risk / Hotspots</h4>

  <div class="analytics-card">
    <span class="label">Top assets by overdue workload</span>

    <!-- KPI LIST -->
    <div id="kpiTopAssetsOverdueList" class="analytics-list">
      <div class="analytics-empty">â€”</div>
    </div>
  </div>
</section>

    <!-- =====================
         ACTIONS
    ===================== -->
    <div class="modal-actions">
      <button class="btn-secondary" id="closeAnalyticsBtn">
        Close
      </button>
    </div>

  </div>
</div>

<!-- =====================
     HISTORY VIEW MODAL
===================== -->
<div id="historyViewOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide history-view-box">

    <h3>ğŸ“‹Execution Details</h3>

    <div id="historyViewContent" class="history-view-grid"></div>

    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeHistoryView()">Close</button>
    </div>

  </div>
</div>

  <!-- =====================
     ADD TASK MODAL â€“ INDUSTRIAL v2
  ===================== -->
  <div id="addTaskOverlay" class="modal-overlay" style="display:none;">
    <div class="modal-box modal-wide" id="addTaskModal">

    <!-- =====================
         HEADER / CONTEXT
    ====================== -->
    <div class="addtask-header">
      <h3 id="addTaskTitle">New Work Order</h3>
      <div class="addtask-context">
        <span id="ctx-asset">ğŸ­ Asset context will be used</span>
        <span id="ctx-location">Line / Section / Unit</span>
      </div>
    </div>

    <!-- =====================
         TASK INTENT
    ====================== -->
    <div class="addtask-block">
      <label>Work Order Type</label>
      <select id="taskPlannedType">
        <option value="planned">ğŸŸ¨ Planned Task</option>
        <option value="unplanned">ğŸŸ¥ Breakdown / Unplanned</option>
      </select>
    </div>

    <!-- =====================
         ASSET / LOCATION
    ====================== -->
    <div class="addtask-block addtask-grid">

      <div class="field">
        <label>Line</label>
        <select id="nt-line">
          <option value="">Select Line</option>
        </select>
      </div>

      <div class="field">
        <label>Asset</label>
        <select id="nt-asset" disabled>
          <option value="">Select Asset</option>
        </select>
      </div>

      <div class="field">
        <label>Section</label>
        <input id="nt-section" placeholder="Section" />
      </div>

      <div class="field">
        <label>Unit</label>
        <input id="nt-unit" placeholder="Unit" />
      </div>

    </div>

  <!-- =====================
    TASK DEFINITION
===================== -->
<div class="addtask-block">
  <label>Task Description</label>
  <input
    id="nt-task"
    placeholder="Describe the maintenance task"
  />
</div>

    <!-- =====================
        TASK TYPE
    ===================== -->
    <div class="addtask-block addtask-grid">
      <div class="field">
        <label>Task Type</label>
        <input
          id="nt-type"
          placeholder="Inspection / Repair / Adjustment"
        />
      </div>
    </div>

    <!-- =====================
        EXECUTION (UNPLANNED / BREAKDOWN)
    ===================== -->
    <div class="addtask-block addtask-grid unplanned-only">

      <div class="field">
        <label>Technician</label>
        <input
          id="nt-technician"
          placeholder="Technician name"
        />
      </div>

      <div class="field">
        <label>Service Time (minutes)</label>
        <input
          id="nt-breakdown-duration"
          type="number"
          min="1"
          step="1"
          placeholder="e.g. 45"
        />
        <small class="field-hint">
          Actual time spent resolving the breakdown
        </small>
      </div>

      <!-- âœ… FULL WIDTH â€“ WORKS NOW -->
      <div class="field full-width">
        <label>Breakdown Date</label>
        <input
          id="nt-breakdown-date"
          type="date"
        />
      </div>
    </div>

    <!-- =====================
        SCHEDULING (PLANNED)
    ===================== -->
    <div class="addtask-block addtask-grid planned-only">

      <div class="field">
        <label>Due Date</label>
        <input
          id="nt-due"
          type="date"
        />
      </div>

      <div class="field">
        <label>Estimated Duration (min)</label>
        <input
          id="nt-duration"
          type="number"
          min="1"
          step="1"
          placeholder="e.g. 30"
        />
        <small class="field-hint">
          Used for planning & workload KPIs
        </small>
      </div>

    </div>

    <!-- =====================
        NOTES
    ===================== -->
    <div class="addtask-block">
      <label>Notes</label>
      <textarea
        id="nt-notes"
        rows="3"
        placeholder="Observations, findings, instructions"
      ></textarea>
    </div>

    <!-- =====================
         ACTIONS
    ====================== -->
    <div class="modal-actions">
      <button id="cancelAddTask" class="btn-cancel">
        Cancel
      </button>
      <button id="saveTaskBtn" class="btn-table">
        âœ” Create Work Order
      </button>
    </div>

  </div>
</div>

<body>

   
<!-- =====================
     CONFIRM TASK DONE MODAL
===================== -->
<div id="modalOverlay" class="modal-overlay">
  <div class="modal-box">

    <h3>ÎŸÎ»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ· Î•ÏÎ³Î±ÏƒÎ¯Î±Ï‚</h3>

    <!-- Technician -->
    <p>Î Î¿Î¹Î¿Ï‚ Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎµ Ï„Î·Î½ ÎµÏÎ³Î±ÏƒÎ¯Î±;</p>
    <input
      type="text"
      id="technicianInput"
      placeholder="ÎŒÎ½Î¿Î¼Î± Ï„ÎµÏ‡Î½Î¹ÎºÎ¿Ï"
    />

    <!-- Completion date -->
    <p style="margin-top:10px;">Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î¿Î»Î¿ÎºÎ»Î®ÏÏ‰ÏƒÎ·Ï‚</p>
    <input
      type="date"
      id="completedDateInput"
    />

    <!-- ğŸ†• Execution Notes -->
    <p style="margin-top:10px;">Î£Î·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚</p>
    <textarea
      id="doneNotesInput"
      placeholder="Î Î±ÏÎ±Ï„Î·ÏÎ®ÏƒÎµÎ¹Ï‚ / ÏƒÎ·Î¼ÎµÎ¹ÏÏƒÎµÎ¹Ï‚ ÎµÎºÏ„Î­Î»ÎµÏƒÎ·Ï‚"
      rows="3"
      style="width:100%; resize:vertical;"
    ></textarea>

    <!-- Actions -->
    <div class="modal-actions">
      <button id="confirmDone" class="btn-table">âœ” Î•Ï€Î¹Î²ÎµÎ²Î±Î¯Ï‰ÏƒÎ·</button>
      <button id="cancelDone" class="btn-cancel">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
    </div>

  </div>
</div>

  
<div class="app-shell">

  <!-- IMPORT PREVIEW MODAL -->
    
<div id="importPreviewOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide import-modal">

    <h3>Excel Import Preview</h3>
    <div id="importSummary" class="docs-subtitle"></div>

    <!-- SCROLLABLE BODY -->
    <div class="import-modal-body">
      <div class="table-card">
        <table id="importPreviewTable">
          <thead>
            <tr>
              <th>Excel Row</th>
              <th>Line</th>
              <th>Machine</th>
              <th>S.N</th>
              <th>Task</th>
              <th>Status</th>
              <th>Error</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- FIXED FOOTER -->
    <div class="import-modal-footer">
      <button id="confirmImportBtn" class="btn-table">âœ… Confirm Import</button>
      <button id="closeImportPreviewBtn" class="btn-cancel">Close</button>
    </div>

  </div>
</div>

    <!-- HEADER -->
    <header class="app-header">
      <div class="app-header-main">
        <div class="app-title">
          <span class="logo-dot"></span>
          ASTIR CMMS
        </div>
        <div class="app-subtitle">Maintenance â€“ Supervisor View</div>
      </div>
      
      <div class="app-header-meta">
        <div class="pill">
          Backend Live: PostgreSQL â€¢ Render
        </div>
        <div id="importStatus" class="import-status">
         No Excel imported yet
        </div>
        <span class="snapshot-note" id="snapshotStatus">
          No snapshot loaded        
        </span>        
      </div>

      <!-- =====================
      DEV LOGIN (ROLE SWITCH)
        ===================== -->

      <div id="devLogin" style="display:flex; gap:8px; align-items:center;">
        <span style="opacity:0.7;">ğŸ‘¤ Role:</span>
        <span id="loggedRoleBadge" class="role-badge" style="display:none;">
          Logged as: <strong id="loggedRoleText"></strong>
        </span>        
      </div>

      <button
        id="logoutBtn"
        class="btn-secondary"
        style="display:none;"
      >
        ğŸšª Logout
      </button>

  </header>
  

  <!-- MAIN TABS -->
<section class="main-tabs">
  <button class="main-tab active" data-tab="dashboard">Dashboard</button>
  <button class="main-tab" data-tab="assets">Assets</button>
  <button class="main-tab" data-tab="tasks">Tasks</button>  
  <button class="main-tab" data-tab="reports">Reports</button>
  <button class="main-tab" data-tab="library">Library</button>
  <button class="main-tab" data-tab="docs">Documentation</button>

  <!-- ğŸ”§ ADMIN / TOOLS -->
  <div class="top-tools">
    <label class="btn-secondary admin-only">
      ğŸ“‚ Upload Excel
      <input type="file" id="excelFile" accept=".xlsx,.xls,.xlsm" hidden />
    </label>
    <button class="btn-secondary admin-only" id="importExcelBtn">ğŸ“¥ Import Excel</button>
    <button class="btn-secondary admin-only" id="exportSnapshot">ğŸ“¦ Export Snapshot</button>
    <label class="btn-secondary admin-only">
      â™» Load Snapshot
      <input type="file" id="snapshotFile" accept="application/json" hidden />
    </label>
    <button class="btn-secondary admin-only" id="restoreSnapshot">Restore</button>
  </div>
</section>

<!-- DASHBOARD TAB -->
  <div id="tab-dashboard" class="tab-panel active">
      <div class="dashboard-header">
          <div class="dashboard-title">
            Asset Overview
            <span id="dashboardRiskCount" class="dashboard-count"></span>
          </div>
          <div class="dashboard-subtitle">
          Assets with overdue tasks, upcoming work or recent breakdowns
          </div>
      </div>
      <div class="dashboard-filters">
        <div class="filter-group risk">
          <button class="filter-btn active" data-risk="all">All</button>
          <button class="filter-btn" data-risk="critical">ğŸ”´ Critical</button>
          <button class="filter-btn" data-risk="risk">ğŸŸ  At Risk</button>
          <button class="filter-btn" data-risk="watch">ğŸŸ¡ Watch</button>
        </div>

        <div class="filter-group flags">
          <label class="filter-flag">
            <input type="checkbox" id="filterOverdueOnly" />
            Overdue only
          </label>

          <label class="filter-flag">
            <input type="checkbox" id="filterBrokenRecent" />
            âš¡ Broken &lt; 7d
          </label>
        </div>

      </div>

      <label class="dashboard-toggle">
          <input type="checkbox" id="compactDashboardToggle" checked />
          Compact view
      </label>

      <div id="assetDashboard">
        <div id="assetDashboardCards"></div>
      </div>
  </div>

<!-- =====================
     ADD PREVENTIVE MODAL
===================== -->
<div id="addPreventiveOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide preventive-modal">

    <!-- HEADER -->
    <div class="preventive-header">
      <h3>â• Preventive Maintenance Plan</h3>
      <p class="modal-subtitle">
        Create a recurring preventive maintenance rule
      </p>
    </div>

    <!-- =====================
         SECTION: ASSET
    ===================== -->
    <section class="preventive-section">
      <h4 class="section-title">ğŸ­ Asset</h4>

      <div class="form-grid">
        <div class="field full">
          <label>Asset</label>
          <select id="pm-asset">
            <option value="">Select Asset</option>
          </select>
        </div>

        <div class="field">
          <label>Line</label>
          <input id="pm-line" disabled placeholder="Auto" />
        </div>

        <div class="field">
          <label>Machine</label>
          <input id="pm-machine" disabled placeholder="Auto" />
        </div>

        <div class="field">
          <label>Serial</label>
          <input id="pm-serial" disabled placeholder="Auto" />
        </div>
      </div>
    </section>

    <!-- =====================
         SECTION: LOCATION
    ===================== -->
    <section class="preventive-section">
      <h4 class="section-title">ğŸ“ Location</h4>

      <div class="form-grid">
        <!-- SECTION -->
        <div class="field">
          <label>Section</label>
          <select id="pm-section">
            <option value="">All Sections</option>
            <!-- populated dynamically -->
            <option value="__new__">â• New sectionâ€¦</option>
          </select>

          <input
            id="pm-section-custom"
            type="text"
            placeholder="Enter new section"
            style="display:none; margin-top:6px;"
          />
        </div>

        <!-- UNIT -->
        <div class="field">
          <label>Unit</label>
          <select id="pm-unit">
            <option value="">All Units</option>
            <!-- populated dynamically -->
            <option value="__new__">â• New unitâ€¦</option>
          </select>

          <input
            id="pm-unit-custom"
            type="text"
            placeholder="Enter new unit"
            style="display:none; margin-top:6px;"
          />
        </div>
      </div>
    </section>

    <!-- =====================
         SECTION: PREVENTIVE DEFINITION
    ===================== -->
    <section class="preventive-section">
      <h4 class="section-title">ğŸ“ Preventive Definition</h4>

      <div class="form-grid">
        <div class="field full">
          <label>Task Description *</label>
          <textarea
            id="pm-task"
            rows="2"
            placeholder="Describe the preventive maintenance task"
          ></textarea>
        </div>

        <div class="field">
          <label>Maintenance Type</label>
          <input
            id="pm-type"
            placeholder="Inspection / Lubrication / Adjustment"
          />
        </div>

        <div class="field">
          <label>Estimated Duration (min)</label>
          <input
            id="pm-duration"
            type="number"
            min="1"
            step="1"
            placeholder="e.g. 30"
          />
        </div>
      </div>
    </section>

    <!-- =====================
         SECTION: FREQUENCY
    ===================== -->
    <section class="preventive-section highlight">
      <h4 class="section-title">ğŸ” Recurrence Rule</h4>

      <div class="form-grid">
        <div class="field">
          <label>Every *</label>
          <input
            id="pm-frequency-value"
            type="number"
            min="1"
            step="1"
            placeholder="e.g. 360"
          />
        </div>

        <div class="field">
          <label>Unit *</label>
          <select id="pm-frequency-unit">
            <option value="">Select</option>
            <option value="hours">Hours</option>
            <option value="days">Days</option>
          </select>
        </div>

        <div class="field full">
          <small class="field-hint">
            This preventive will repeat automatically based on this rule.
          </small>
        </div>
      </div>
    </section>

    <!-- =====================
         SECTION: FIRST EXECUTION
    ===================== -->
    <section class="preventive-section">
      <h4 class="section-title">ğŸ“… First Execution</h4>

      <div class="form-grid">
        <div class="field">
          <label>First Due Date *</label>
          <input
            id="pm-first-due"
            type="date"
          />
        </div>

        <div class="field full">
          <small class="field-hint">
            This date will create the first preventive work order.
          </small>
        </div>
      </div>
    </section>

    <!-- =====================
         SECTION: NOTES
    ===================== -->
    <section class="preventive-section">
      <h4 class="section-title">ğŸ—’ Notes</h4>

      <div class="form-grid">
        <div class="field full">
          <textarea
            id="pm-notes"
            rows="3"
            placeholder="Additional instructions, safety notes, observations"
          ></textarea>
        </div>
      </div>
    </section>

    <!-- =====================
         ACTIONS
    ===================== -->
    <div class="modal-actions">
      <button
        class="btn-secondary"
        onclick="document.getElementById('addPreventiveOverlay').style.display='none'">
        Cancel
      </button>

      <button
        id="savePreventiveBtn"
        class="btn-primary">
        âœ” Save Preventive
      </button>
    </div>

  </div>
</div>


<!-- =====================
     EDIT PREVENTIVE MODAL
===================== -->
<div id="editPreventiveOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide preventive-modal">

    <!-- HEADER -->
    <div class="preventive-header">
      <h3>âœï¸ Edit Preventive Maintenance</h3>
      <p class="modal-subtitle">
        Changes apply to future work orders only
      </p>
    </div>

    <!-- =====================
         CONTEXT (READ-ONLY)
    ===================== -->
    <div class="preventive-context">
      <span class="pill">
        ğŸ­ <strong id="ep-asset-model">â€”</strong>
      </span>
      <span class="pill">
        ğŸ“ Section: <strong id="ep-section">â€”</strong>
      </span>
      <span class="pill">
        ğŸ” Frequency: <strong id="ep-frequency-label">â€”</strong>
      </span>
    </div>

    <!-- =====================
        AFFECTED ASSETS INFO
    ===================== -->
    <div
      id="ep-affected-info"
      class="preventive-info-banner"
      style="display:none;"
    >
      â„¹ï¸ This preventive rule applies to
      <strong id="ep-affected-count">0</strong>
      assets of this model.
      <span class="muted">
        Changes will affect future work orders only.
      </span>
    </div>

    <!-- =====================
         FORM
    ===================== -->
    <div class="preventive-form">
      <!-- Unit (LOCKED) -->
      <div class="field">
        <label>Unit</label>
        <input
          id="ep-unit"
          type="text"
          disabled
          class="locked"
        />
      </div>

      <!-- Task -->
      <div class="field full-width">
        <label>Task Description</label>
        <input
          id="ep-task"
          type="text"
          placeholder="Describe preventive task"
        />
      </div>

      <!-- Type -->
      <div class="field">
        <label>Task Type</label>
        <input
          id="ep-type"
          type="text"
          placeholder="Inspection / Lubrication / Adjustment"
        />
      </div>      

      <!-- Frequency -->
      <div class="field">
        <label>Frequency (hours)</label>
        <input
          id="ep-frequency"
          type="number"
          min="1"
          step="1"
          placeholder="e.g. 360"
        />
        <small class="field-hint">
          Used to generate future preventive work orders
        </small>
      </div>

      <!-- Duration -->
      <div class="field">
        <label>Estimated Duration (min)</label>
        <input
          id="ep-duration"
          type="number"
          min="1"
          step="1"
          placeholder="e.g. 45"
        />
      </div>

      <!-- Notes -->
      <div class="field full-width">
        <label>Notes</label>
        <textarea
          id="ep-notes"
          rows="3"
          placeholder="Instructions, safety notes, toolsâ€¦"
        ></textarea>
      </div>

    </div>

    <!-- =====================
         FOOTER ACTIONS
    ===================== -->
    <div class="modal-actions preventive-actions">

      <button
        class="btn-warning"
        id="disablePreventiveBtn"
        title="Disable this preventive plan">
        ğŸš« Disable Preventive
      </button>

      <div class="spacer"></div>

      <button
        class="btn-secondary"
        onclick="closeEditPreventiveModal()">
        Cancel
      </button>

      <button
        class="btn-primary"
        id="saveEditPreventiveBtn">
        ğŸ’¾ Save Changes
      </button>

    </div>

  </div>
</div>


<!-- ===================== -->
<!-- TAB: PREVENTIVE LIBRARY -->
<!-- ===================== -->
<div id="tab-library" style="display:none;">  
  <section class="library-header">
    <div class="library-header-left">
      <h2>
        Preventive Maintenance Library
        <span
          class="library-info"
          title="Preventive maintenance plans and recurring rules">
          â“˜
        </span>
      </h2>
    </div>

    <div class="library-header-actions">
      <button
        id="addPreventiveBtn"
        class="btn-secondary btn-preventive">
        â• Add Preventive
      </button>
    </div>
  </section>

  <section class="library-controls">
    <label for="libraryModelSelect">Asset Model</label>
    <select id="libraryModelSelect">
      <option value="">â€” Select model â€”</option>
      <option value="PMC250">PMC250</option>
      <option value="PMC300">PMC300</option>
      <option value="PMC500">PMC500</option>
      <option value="PTC027">PTC027</option>
    </select>
    <button
      class="btn-secondary"
      onclick="generateLibraryFromTasks()">
      ğŸ” Generate from Live Tasks
    </button>
    <button
      class="btn-secondary"
      id="printLibraryBtn"
      title="Print preventive plan">
      ğŸ–¨ Print
    </button>    
  </section>

  <section class="library-content" id="libraryContent">
    <div class="library-empty">
      Select an asset model to view its preventive plan
    </div>
  </section>
</div>

<!-- =====================
     CONFIRM PREVENTIVE APPLY
===================== -->
<div
  id="confirmPreventiveApplyOverlay"
  class="modal-overlay"
  style="display:none;"
>
  <div class="modal-box modal-small">

    <h3>Apply Preventive Changes</h3>

    <p class="modal-subtitle">
      This rule is used by
      <strong id="cp-asset-count">0</strong>
      assets.
    </p>

    <p style="font-size:0.85rem; opacity:0.85;">
      Apply changes to all assets using this preventive rule?
      <br>
      <span style="opacity:0.7;">
        Only future work orders will be affected.
      </span>
    </p>

    <div class="modal-actions">
      <button
        class="btn-secondary"
        onclick="closePreventiveConfirm()"
      >
        Cancel
      </button>

      <button
        class="btn-primary"
        id="confirmApplyPreventiveBtn"
      >
        âœ” Apply to all assets
      </button>
    </div>

  </div>
</div>
    
    <!-- ===================== -->
    <!-- TAB: TASKS -->
    <!-- ===================== -->
    <div id="tab-tasks">

      <!-- KPIs -->
      <section class="kpi-strip">
        <article class="kpi-card">
          <span class="kpi-label">Total</span>
          <span id="kpiTotal" class="kpi-value">0</span>
        </article>
        <article class="kpi-card">
          <span class="kpi-label">Overdue</span>
          <span id="kpiOverdue" class="kpi-value">0</span>
        </article>
        <article class="kpi-card">
          <span class="kpi-label">Due â‰¤ 7 days</span>
          <span id="kpiSoon" class="kpi-value">0</span>
        </article>
        <article class="kpi-card">
          <span class="kpi-label">Completed</span>
          <span id="kpiDone" class="kpi-value">0</span>
        </article>
      </section>     

      <!-- FILTERS -->

  <div class="controls-row">
    <button class="btn-secondary task-type-btn planned" data-type="planned">
            ğŸŸ¨ Planned
    </button>

    <button class="btn-secondary task-type-btn preventive" data-type="preventive">
            ğŸ”µ Preventive
      </button>
    <button class="btn-secondary date-filter-btn active" data-filter="all">All</button>
    <button class="btn-secondary date-filter-btn" data-filter="today">Today</button>
    <button class="btn-secondary date-filter-btn" data-filter="week">This Week</button>
    <button class="btn-secondary date-filter-btn" data-filter="overdue">Overdue</button>                

    <button class="btn-secondary" id="openHistoryBtn">ğŸ“‹ History</button>
    <button class="btn-secondary" id="openAnalyticsBtn">ğŸ“Š KPI / Analytics
</button>
    
  </div>    

<section class="controls-row">
  <div class="asset-dropdown" id="assetDropdown">
    <button class="asset-dropdown-btn" id="assetDropdownBtn">
     All Machines
    </button>
    <div class="asset-dropdown-menu" id="assetDropdownMenu"></div>
  </div>

  <button class="btn-secondary admin-only" id="addTaskBtn">â• New Task</button>  
  
<div class="date-range-pill">
  <span class="date-range-label">ğŸ“…</span>

  <input
    id="taskDateFrom"
    type="date"
    onchange="onTaskDateRangeChange()"
  />

  <span class="date-range-sep">â†’</span>

  <input
    id="taskDateTo"
    type="date"
    onchange="onTaskDateRangeChange()"
  />
</div>
<span id="tasksCountLabel" class="tasks-count-label">
  0 tasks
</span>

  <!-- ğŸ” GLOBAL SEARCH -->
  <input
    type="text"
    id="taskSearch"
    placeholder="ğŸ” Search task / machine / serial"
    class="task-search"
  />
  <button class="btn-secondary" id="printTasksBtn">ğŸ–¨ï¸ Print Tasks</button>
</section>

  <!-- =====================
     GROUP DONE ACTION BAR (MOCK)
     ÎµÎ¼Ï†Î±Î½Î¯Î¶ÎµÏ„Î±Î¹ ÏŒÏ„Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ selected tasks (ÏƒÏ„Î¿ JS)
===================== -->
<section id="bulkActionsBar" class="bulk-actions" style="display:none;">
  <div class="bulk-actions-left">
    <strong id="bulkSelectedCount">0</strong>
    <span>selected</span>
    <button class="btn-secondary" id="bulkClearBtn" type="button">Clear</button>
  </div>

  <div class="bulk-actions-right">
    <button class="btn-table" id="bulkDoneBtn" type="button">
      âœ” Mark Selected as Done
    </button>
  </div>
</section>

      <!-- TASK TABLE -->
      <div class="table-card">
        <table id="tasksTable">
          <thead>
            <tr>
              <th>Machine</th>
              <th>Section</th>
              <th>Unit</th>
              <th style="width: 25%;">Task</th>
              <th>Type</th>
              <th>Due Date</th>
              <th style="width: 7%;">Status</th>
              <th style="width: 7%;">Action</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    
    <!-- ===================== -->
    <!-- TAB: DOCUMENTATION -->
    <!-- ===================== -->
    <div id="tab-docs" style="display: none;">

      <section class="docs-header">
        <h2>
          Documentation â€“ MasterPlan
          <span class="docs-hint">Î•Ï€Î¯ÏƒÎ·Î¼Î¿ MasterPlan PDF Ï„Î¿Ï… ÎµÏÎ³Î¿ÏƒÏ„Î±ÏƒÎ¯Î¿Ï…</span>
        </h2>
      </section>

      <section class="docs-controls">
        <label class="btn-secondary">
          ğŸ“¤ Upload MasterPlan PDF
          <input type="file" id="pdfInput" accept="application/pdf" hidden />
        </label>
        <button class="btn-secondary" id="openPdfBtn">ğŸ“„ Î ÏÎ¿Î²Î¿Î»Î® PDF</button>
      </section>

      <section class="docs-viewer-wrapper">
        <iframe
          id="pdfViewer"
          class="docs-viewer"
          src=""
          title="MasterPlan PDF"
        ></iframe>
      </section>

    </div>
    
<!-- TAB: ASSETS --> 
 
<div id="tab-assets" style="display:none;">

  <section class="assets-header">
    <h2>Assets Management</h2>
    <p class="docs-subtitle">
      Î”Î¹Î±Ï‡ÎµÎ¯ÏÎ¹ÏƒÎ· Î¼Î·Ï‡Î±Î½ÏÎ½ Î±Î½Î¬ Î³ÏÎ±Î¼Î¼Î®
    </p>
  </section>

  <div class="filter-group">
    <label for="assetLineFilter">Line:</label>
    <select id="assetLineFilter">
      <option value="all">All</option>
    </select>

    <section class="controls-row">
      <button class="btn-secondary" id="addAssetBtn">â• Add Asset</button>
    </section>
  </div>

  <!-- ğŸ”´ Legacy table (kept, but hidden by cards renderer) -->
  <div class="table-card assets-scroll">
    <table id="assetsTable">
      <thead>
        <tr>
          <th>Line</th>
          <th>Machine</th>
          <th>Serial Number</th>
          <th>Last Activity</th>
          <th style="width:14%">Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- ğŸŸ¢ NEW: Asset Cards View -->
  <div id="assetsCardsView" class="assets-cards"></div>

</div>
    
    <!-- ===================== 
      TAB: REPORTS
    ===================== -->

<div id="tab-reports" style="display: none;">
  <section class="reports-header">
    <h2>Reports</h2>
    <p class="reports-subtitle">
      Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± Î±Î½Î±Ï†Î¿ÏÏÎ½ ÏƒÏ…Î½Ï„Î®ÏÎ·ÏƒÎ·Ï‚ ÎºÎ±Î¹ export ÏƒÎµ PDF.
    </p>
  </section>

  <section class="reports-card">
    <div class="reports-grid">

      <!-- Report Type -->
      <div class="field">
        <label for="reportType">Report Type</label>
        <select id="reportType">
          <option value="status">Maintenance Status Report</option>
          <option value="overdue">Overdue Tasks Report</option>
          <option value="technician">Completed by Technician</option>
          <option value="nonplanned">Breakdowns Report</option>
          <option value="kpi">Maintenance KPI Report</option>
        </select>
      </div>

      <!-- REPORTS: Date Range (compact like Tasks) -->
      <div class="report-date-range-pill">
          <span class="date-range-label">ğŸ“…</span>

        <input id="dateFrom" type="date" />

          <span class="date-range-sep">â†’</span>

        <input id="dateTo" type="date" />
      </div>
      
      <!-- Line -->
      <div class="field field-right">
        <label for="reportLine">Line</label>
        <select id="reportLine">
          <option value="all">ALL</option>
          <option value="L1">L1</option>
          <option value="L2">L2</option>
          <option value="L3">L3</option>
          <option value="L4">L4</option>
          <option value="L5">L5</option>
          <option value="L6">L6</option>
          <option value="L7">L7</option>
        </select>
      </div>
      <!-- Status -->
      <div class="field field-right">
        <label for="reportStatus">Status</label>
        <select id="reportStatus">
          <option value="all">ALL</option>
          <option value="planned">Preventive</option>
          <option value="planned_manual">Planned_manual</option>
          <option value="overdue">Overdue</option>
        </select>
      </div>

      <!-- Technician (hidden for now; Î¸Î± Ï„Î¿ ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¹Î®ÏƒÎ¿Ï…Î¼Îµ ÏƒÏ„Î¿ STEP B) -->
      <div class="field field-hidden" id="fieldTechnician">
        <label for="reportTechnician">Technician</label>
        <input id="reportTechnician" type="text" placeholder="Ï€.Ï‡. Giorgos" />
      </div>

    </div>

    <!-- Preview -->
    <div class="reports-preview" id="reportsPreview">
      <div class="preview-title">Preview</div>
      <div class="preview-lines" id="previewLines">Lines: ALL</div>
      <div class="preview-dates" id="previewDates">Period: â€”</div>
      <div class="preview-type" id="previewType">Report: Maintenance Status Report</div>
      <div class="preview-status" id="previewStatus">Status: ALL</div>
    </div>

    <!-- Actions -->
    <div class="reports-actions">
      <button class="btn-primary" id="generatePdfBtn">ğŸ“„ Generate PDF</button>
      <button class="btn-secondary" id="resetReportBtn">Reset</button>
    </div>
  </section>
 </div>
</div>
   
<!-- =====================
     ASSET VIEW MODAL
===================== -->
<div id="assetViewOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box modal-wide asset-view">

    <!-- HEADER -->
    <div class="asset-view-header">
      <h3 id="assetViewTitle">
        Asset
        <small class="asset-sn">SN</small>
      </h3>

      <div class="asset-view-meta">
        <span class="pill">Line: <strong id="assetViewLine">â€”</strong></span>
        <span class="pill">Status: <strong id="assetViewStatus">â€”</strong></span>
      </div>
    </div>

    <!-- =====================
         ASSET VIEW TABS
    ===================== -->
    <div class="asset-tabs">
      <button class="asset-tab active" data-tab="overview">Overview</button>
      <button class="asset-tab" data-tab="active">Active Tasks</button>
      <button class="asset-tab" data-tab="history">History</button>
    </div>

    <!-- =====================
         TAB: OVERVIEW
    ===================== -->
    <div class="asset-tab-panel active" data-panel="overview">

      <div class="asset-view-description">
        <p id="assetViewDescription">
          Asset description / notes will appear here.
        </p>
      </div>

      <section class="kpi-strip asset-kpis">
        <article class="kpi-card">
          <span class="kpi-label">Planned</span>
          <span class="kpi-value" id="assetPlannedCount">0</span>
        </article>

        <article class="kpi-card">
          <span class="kpi-label">Overdue</span>
          <span class="kpi-value" id="assetOverdueCount">0</span>
        </article>

        <article class="kpi-card">
          <span class="kpi-label">History</span>
          <span class="kpi-value" id="assetHistoryCount">0</span>
        </article>

        <article class="kpi-card kpi-metrics">
          <div class="kpi-metric">
            <span class="kpi-label">MTBF</span>
            <span class="kpi-value" id="assetMtbfValue">â€”</span>
          </div>

          <div class="kpi-divider"></div>

          <div class="kpi-metric">
            <span class="kpi-label">MTTR</span>
            <span class="kpi-sub" id="assetMttrValue">â€”</span>
          </div>

          
           <span class="kpi-sub" id="assetLastBreakdown">
            <span class="kpi-icon">ğŸ•’</span>
            â€”
          </span>
          
        </article>      
      </section>
    </div>

      <!-- =====================
      TAB: ACTIVE TASKS
      ===================== -->
    <div class="asset-tab-panel" data-panel="active">
        <!-- =====================
        ACTIVE TASKS LEGEND
        ===================== -->
          <div class="asset-status-legend">
            <span class="legend-item preventive">
              <span class="dot"></span> Preventive
            </span>
            <span class="legend-item planned">
              <span class="dot"></span> Planned (Manual)
            </span>
          </div>

      <div class="table-card asset-tasks-table">
        <table id="assetTasksTable">
          <thead>
            <tr>
              <th></th> <!-- checkbox column -->
              <th>Status</th>
                <th>Unit</th>
                <th>Task</th>            
                <th>Type</th>
                <th>Due Date</th>
                <th>Duration</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <!-- =====================
          ASSET BULK ACTION BAR (STEP 2)
      ===================== -->
      <div
        id="assetBulkActionsBar"
        class="bulk-actions"
        style="display:none; margin-top:10px;"
      >
        <div class="bulk-actions-left">
          <strong id="assetBulkSelectedCount">0</strong>
          <span>selected</span>
          <button
            class="btn-secondary"
            type="button"
            id="assetBulkClearBtn"
          >
            Clear
          </button>
        </div>

        <div class="bulk-actions-right">
          <button
            class="btn-table"
            type="button"
            id="assetBulkDoneBtn"
          >
            âœ” Bulk Done
          </button>
        </div>
      </div>
    </div>

      <!-- =====================
          TAB: HISTORY
      ===================== -->
      <div class="asset-tab-panel" data-panel="history">

        <div class="table-card asset-history-table">
          <table id="assetHistoryTable">
            <thead>
              <tr>
                <th>Status</th>
                <th>Task</th>
                <th>Type</th>
                <th>Executed At</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
          <div class="asset-history-legend">
            <div class="legend-item clickable" data-type="all">
              <strong id="histAllCount">0</strong>
              <span>All</span>
            </div>

            <div class="legend-item clickable breakdown" data-type="unplanned">
              <strong id="assetHistoryCountBreakdown">0</strong>
              <span>Breakdowns</span>
            </div>

            <div class="legend-item clickable preventive" data-type="preventive">
              <strong id="assetHistoryCountPreventive">0</strong>
              <span>Preventive</span>
            </div>

            <div class="legend-item clickable planned" data-type="planned">
              <strong id="assetHistoryCountPlanned">0</strong>
              <span>Planned</span>
            </div>
          </div>
      </div>

      <!-- ACTIONS -->
      <div class="asset-view-footer">
        <div class="modal-actions">
          <button
            class="btn-secondary"
            onclick="closeAssetView()">
            Close
          </button>

          <button
            id="printAssetPreventiveBtn"
            class="btn-secondary"
            style="display:none;">
            ğŸ–¨ Print Preventive Plan
          </button>

        </div>
      </div>
  </div>
</div>

  <!-- =====================
     ADD ASSET MODAL
===================== -->
  <div id="addAssetOverlay" class="modal-overlay" style="display:none;">
    <div class="modal-box modal-small">
    <h3>â• Add Asset</h3>
    <!-- LINE -->
    <div class="field">
      <label>Line</label>
      <select id="assetLine">
        <option value="">Select Line</option>
        <!-- populated from DB -->
        <option value="__other__">â• Otherâ€¦</option>
      </select>
    </div>


    <!-- NEW LINE (conditional) -->
    <div class="field" id="newLineField" style="display:none;">
      <label>New Line</label>
      <input
        type="text"
        id="assetNewLine"
        placeholder="e.g. L8 / Packaging"
      />
    </div>
    
    <!-- MACHINE -->
    <div class="field">
      <label>Machine</label>
      <select id="assetMachine">
       <option value="">Select Machine</option>
       <option value="PMC250">PMC250</option>
       <option value="PMC300">PMC300</option>
       <option value="PMC500">PMC500</option>
       <option value="PTC027">PTC027</option>
        <option value="__other__">â• Otherâ€¦</option>
     </select>
    </div>
    <!-- NEW MACHINE (conditional) -->
    <div class="field" id="newMachineField" style="display:none;">
      <label>New Machine</label>
      <input
        type="text"
        id="assetNewMachine"
        placeholder="Machine model"
      />
    </div>

    <!-- SERIAL NUMBER -->
    <div class="field">
      <label>Serial Number</label>
      <input
        type="text"
        id="assetSn"
        placeholder="Serial Number"
      />
    </div>

    <!-- ACTIONS -->
    <div class="modal-actions">
      <button class="btn-primary" id="saveAssetBtn">ğŸ’¾ Save</button>
      <button class="btn-cancel" id="cancelAssetBtn">Cancel</button>
    </div>

    </div>
  </div>

    <!-- =====================
     EDIT ASSET MODAL
===================== -->
<div id="editAssetOverlay" class="modal-overlay" style="display:none;">
  <div class="modal-box">

    <h3>âœï¸ Edit Asset</h3>

    <div class="addtask-block">
      <label>Line</label>
      <select id="edit-asset-line"></select>
    </div>

    <div class="addtask-block">
      <label>Machine</label>
      <input id="edit-asset-model" />
    </div>

    <div class="addtask-block">
      <label>Serial Number</label>
      <input id="edit-asset-serial" />
    </div>

    <div class="addtask-block addtask-block-vertical">
      <label>Description</label>
      <textarea
        id="edit-asset-description"
        placeholder="Asset notes / description"
      ></textarea>
    </div>

    <div class="modal-actions">
      <button class="btn-secondary" onclick="closeEditAsset()">Cancel</button>
      <button class="btn-primary" id="saveEditAssetBtn">ğŸ’¾ Save</button>
    </div>

  </div>
</div>


  <!-- CORE -->
  <script src="./js/core/utils.js" defer></script>
  <script src="./js/formatters.js" defer></script>

  <!-- FEATURES -->
  <script src="./js/features/auth.js" defer></script>
  <script src="./js/features/analytics.js" defer></script>
  <script src="./js/features/printPreventiveLibrary.js" defer></script>
  <script src="./js/features/importExcel.js" defer></script>
  <script src="./js/features/reports.js" defer></script>
  <script src="./js/features/printWorkOrder.js" defer></script>
  <script src="./js/features/assetDashboard.js" defer></script>
  <script src="./js/features/preventiveLibrary.js" defer></script>

  <!-- APP (state, loaders, globals) -->
  <script src="./app.js" defer></script>
  

</body>
</html>